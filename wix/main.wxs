<?xml version='1.0' encoding='windows-1252'?>
<Wix xmlns='http://schemas.microsoft.com/wix/2006/wi'>
    <Product
        Id='*'
        Name='fastsync'
        UpgradeCode='6E9C0A7B-0A4E-4E3E-8E7B-0A4E4E3E8E7B'
        Manufacturer='Your Team'
        Language='1033'
        Codepage='1252'
        Version='0.1.11'>

        <Package Id='*'
            Keywords='Installer'
            Description='Fast incremental file sync over SSH'
            Manufacturer='Your Team'
            InstallerVersion='450'
            Languages='1033'
            Compressed='yes'
            SummaryCodepage='1252'
            InstallScope='perMachine'/>

        <MajorUpgrade Schedule='afterInstallInitialize' DowngradeErrorMessage='A newer version of [ProductName] is already installed.'/>

        <MediaTemplate EmbedCab='yes'/>

        <Directory Id='TARGETDIR' Name='SourceDir'>
            <Directory Id='ProgramFiles64Folder'>
                <Directory Id='APPLICATIONROOTDIRECTORY' Name='fastsync'/>
            </Directory>
        </Directory>

        <DirectoryRef Id='APPLICATIONROOTDIRECTORY'>
            <Component Id='fastsync_exe' Guid='8F0E1A2B-3C4D-4E5F-8A7B-8A9B0C1D2E3F'>
                <File Id='fastsync_exe' Source='target\x86_64-pc-windows-msvc\release\fastsync.exe' KeyPath='yes' Checksum='yes'/>
                <!-- 添加到 PATH 环境变量 -->
                <Environment Id='PATH' Name='PATH' Value='[APPLICATIONROOTDIRECTORY]' Permanent='no' Part='last' Action='set' System='yes' />
            </Component>
        </DirectoryRef>

        <Feature Id='MainApplication' Title='fastsync' Level='1'>
            <ComponentRef Id='fastsync_exe'/>
        </Feature>

        <UI>
            <UIRef Id='WixUI_Minimal'/>
            <Publish Dialog='ExitDialog' Control='Finish' Event='DoAction' Value='LaunchApplication'>WIXUI_EXITDIALOGOPTIONALCHECKBOX = 1 and NOT Installed</Publish>
        </UI>
        
        <Property Id='WIXUI_EXITDIALOGOPTIONALCHECKBOXTEXT' Value='Launch fastsync'/>
        <Property Id='WixShellExecTarget' Value='[#fastsync_exe]'/>
        <CustomAction Id='LaunchApplication' BinaryKey='WixCA' DllEntry='WixShellExec' Impersonate='yes' />

    </Product>
</Wix>
